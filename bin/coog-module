# vim: set ft=sh:
# modules management - install, update, etc

coog_module_main() { # list installed modules - <db> - default: db uri
        [ ! -z $1 ] && export PGDATABASE=$1
        local module
        for module in `psql -w -t -c "select name from ir_module where state='installed'"`
        do
                echo $module
        done
}

coog_module_update() { # install / update modules - <modules> - default: all
        [ -z $PGDATABASE ] && echo no database defined && return
        local modules
        if [ $# -eq 0 ]
        then
                modules=ir
        else
                modules=$*
        fi
        coog_env_celery
        trytond -v \
                -c $COOG_SRV_CONF \
                -d $PGDATABASE \
                -u $modules
}

coog_module_updatedb() { # install / update all modules - <database> - no default
        [ -z $1 ] && echo no given database && return
        coog_env_celery
        trytond -v \
                -c $COOG_SRV_CONF \
                -d $1 \
                --all
}
