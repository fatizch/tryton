#!/bin/sh

_enter() { # move to bin directory
        local script_path
        local script_dir
        script_path=`readlink -f $0`
        script_dir=`dirname $script_path`
        _wd=`pwd`
        cd $script_dir
}

_leave() { # move back to initial wd
        cd $_wd
}

_usage() { # print usage message
        echo
        echo Usage: coog \<command\> \[\<sub-command\> \[\<args\>\]\]
        echo
        echo "  "For help: coog help
        echo "  "For support: support@coopengo.com
        echo
}

_source() { # source libs
        local fn
        for fn in ./coog-*
        do
                . $fn
        done
}

_main() { # parse params and call fn
        [ $# -eq 0 ] && _usage && return
        local com=$1
        local sub
        local fn
        if [ $# -eq 1 ] || [ $com = help ]
        then
                # implicit sub-command (no args possible)
                sub=main
                shift 1
        else
                # explicit sub-command
                sub=$2
                shift 2
        fi
        fn="coog_"$com"_"$sub
        _source
        $fn $*
}

_enter
_main $*
_leave
