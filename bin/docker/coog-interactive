#!/bin/sh

# This command starts a Coog container in interactive mode
#
# This is useful for example to see server logs, to upgrade modules, etc.
#
# Options explanations: (refer to ./coog-daemon for exhaustive options)
#     - see coog-d for main options
#     -i: interactive mode
#     -t: allocate tty
#     --rm: remove container on exit
#
# Coog image variables: (refer to ./coog-daemon)
#
# More informations: https://docs.docker.com/engine/reference/run/

image=`head -1 ./tags`

data=`pwd`/data/coog

coog_db_user=postgres
coog_db_password=postgres
coog_cache_db=0

sudo docker run \
        -ti --rm \
        --link postgres:postgres \
        -e "COOG_DB_USER=$coog_db_user" \
        -e "COOG_DB_PASSWORD=$coog_db_password" \
        --link redis:redis \
        -e "COOG_CACHE_DB=$coog_cache_db" \
        -v $data:/opt/coog/data \
        coog/$image \
        app -v $*
